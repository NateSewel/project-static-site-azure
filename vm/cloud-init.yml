#cloud-config
package_update: true
package_upgrade: true
packages:
  - nginx
  - git
  - unzip

runcmd:
  - echo "ðŸ“‚ Preparing web directory..."
  - mkdir -p /var/www/html
  - rm -rf /var/www/html/*

  # Clone your GitHub repository directly
  - |
    echo "ðŸ”„ Cloning GitHub repository..."
    if [ -d /var/www/html/.git ]; then
      echo "Repository already exists, pulling latest changes..."
      git -C /var/www/html pull
    else
      git clone https://github.com/NateSewel/project-static-site-azure.git /var/www/html
    fi

  - echo "ðŸ”§ Setting permissions..."
  - chown -R www-data:www-data /var/www/html

  - echo "ðŸš€ Enabling and restarting nginx..."
  - systemctl enable nginx
  - systemctl restart nginx

  - echo "âœ… Cloud-init completed successfully"
  - echo "Your site should now be available on port 80."
