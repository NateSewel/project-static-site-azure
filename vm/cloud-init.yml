#cloud-config
package_update: true
package_upgrade: true
packages:
  - nginx
  - git
runcmd:
  - mkdir -p /var/www/html
  - rm -rf /var/www/html/*
  # Replace <RAW_GITHUB_URL> with the raw link to your site.zip or files (see README)
  - |
    if [ -n "${SITE_GIT_RAW_URL:-}" ]; then
      # If SITE_GIT_RAW_URL is provided as an instance metadata/custom-data var, use curl
      curl -fsSL "${SITE_GIT_RAW_URL}" -o /tmp/site.zip || true
      if [ -f /tmp/site.zip ]; then
        apt-get install -y unzip
        unzip -o /tmp/site.zip -d /var/www/html || true
      fi
    fi
  - chown -R www-data:www-data /var/www/html
  - systemctl enable nginx
  - systemctl restart nginx
  - echo "Cloud-init completed"
  - echo "Your site should be available shortly."
